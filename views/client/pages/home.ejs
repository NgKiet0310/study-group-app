<% layout('layouts/main-client') %>

<% if (typeof success !== "undefined" && success) { %>
  <script>
    alert("<%= success %>");
  </script>
<% } %>

<!-- Hero Section -->
<section class="hero-section py-5 mb-5">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6 hero-content">
        <h1 class="display-4 fw-bold hero-title mb-4">
          Learn Together ðŸŽ“
        </h1>
        <p class="lead text-white mb-4 opacity-90">
          Join the learning community, create study rooms, chat, and share knowledge with friends!
        </p>
        <ul class="feature-list text-white mb-4">
          <li>Create and join online study rooms</li>
          <li>Real-time chat with members</li>
          <li>Share documents and notes</li>
          <li>Plan effective study schedules</li>
        </ul>
        <div class="d-flex gap-3 flex-wrap">
          <a href="#your-rooms" class="btn btn-light btn-lg px-4">
            <i class="fas fa-arrow-down me-2"></i>View Your Rooms
          </a>
          <a href="/create-room" class="btn btn-outline-light btn-lg px-4">
            <i class="fas fa-plus me-2"></i>Create New Room
          </a>
        </div>
      </div>
      <div class="col-lg-6 text-center">
        <img src="https://cdn-icons-png.flaticon.com/512/3593/3593477.png" 
             alt="Study Group" 
             class="img-fluid hero-illustration"
             style="max-height: 400px;">
      </div>
    </div>
  </div>
</section>

<!-- Stats Section -->
<section class="mb-5">
  <div class="container">
    <div class="row">
      <div class="col-md-4">
       <div class="stats-card">
              <span class="stats-number"><%= room ? room.length : 0 %></span>
              <span>Active Study Rooms</span>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stats-card" style="background: linear-gradient(135deg, #dc3545, #e83e8c);">
          <span class="stats-number"><%= users ? users.length : 0 %></span>
          <span>Students Participating</span>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stats-card" style="background: linear-gradient(135deg, #fd7e14, #ffc107);">
          <span class="stats-number"><%= files ? files.length : 0 %></span>
          <span>Shared Documents</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Join Room Section -->
<section class="mb-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-6 col-md-8">
        <div class="card join-room-card">
          <div class="card-header card-header-gradient text-white text-center py-4">
            <h3 class="fw-bold mb-0">
              <i class="fas fa-key me-3"></i>Join a Study Room
            </h3>
            <p class="mb-0 opacity-75 mt-2">Enter the room code to start learning together</p>
          </div>
          <div class="card-body p-4">
            <form action="/api/rooms/join" method="POST">
              <div class="mb-4">
                <label for="code" class="form-label fw-semibold text-muted mb-3">
                  <i class="fas fa-hashtag me-2"></i>Room Code
                </label>
                <input type="text" 
                       class="form-control form-control-modern" 
                       id="code" 
                       name="code" 
                       placeholder="Example: ABC123..." 
                       required>
                <small class="text-muted">Room code consists of 6 characters provided by the instructor</small>
              </div>
              <button type="submit" class="btn btn-gradient w-100">
                <i class="fas fa-door-open me-2"></i>Join Room Now
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Your Rooms Section -->
<section id="your-rooms" class="mb-5">
  <div class="container">
    <h2 class="section-title fw-bold text-primary mb-4">
      <i class="fas fa-book-open me-3"></i>Your Study Rooms
    </h2>
    
    <% if (rooms && rooms.length > 0) { %>
      <div class="row">
        <% rooms.forEach((room, index) => { %>
          <div class="col-lg-4 col-md-6 mb-4">
            <div class="card room-card h-100">
              <div class="room-cover">
                <div class="room-icon">
                  <i class="fas fa-<%= ['book', 'calculator', 'microscope', 'globe', 'atom', 'dna'][index % 6] %>"></i>
                </div>
              </div>
              <div class="card-body p-4">
                <h5 class="card-title mb-3">
                  <a href="/client/room/<%= room._id %>" class="text-decoration-none text-primary fw-bold">
                    <%= room.name %>
                  </a>
                </h5>
                <p class="text-muted mb-3">
                  <%= room.description || 'Online study room for discussions and knowledge sharing.' %>
                </p>
                 <div class="d-flex align-items-center text-muted small mb-3">
                  <i class="fas fa-users me-2"></i>
                  <span class="me-3"><%= room.members ? room.members.length : 0 %> members</span>
                </div>
                <div class="d-grid gap-2">
                  <a href="/room/<%= room._id %>" class="btn btn-primary">
                    <i class="fas fa-door-open me-2"></i>Join Room
                  </a>
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
      
      <!-- Show more button if there are many rooms -->
      <% if (rooms.length > 6) { %>
        <div class="text-center">
          <button class="btn btn-outline-primary btn-lg" onclick="showMoreRooms()">
            <i class="fas fa-chevron-down me-2"></i>View More Rooms
          </button>
        </div>
      <% } %>
      
    <% } else { %>
      <div class="empty-state">
        <div class="empty-icon">
          <i class="fas fa-book-open"></i>
        </div>
        <h4 class="fw-bold text-muted mb-3">No Study Rooms Yet</h4>
        <p class="text-muted mb-4">
          You haven't joined any study rooms. Enter a room code or create a new room to start!
        </p>
        <div class="d-flex gap-3 justify-content-center flex-wrap">
          <a href="#" class="btn btn-primary" onclick="document.getElementById('code').focus()">
            <i class="fas fa-key me-2"></i>Enter Room Code
          </a>
          <a href="/create-room" class="btn btn-outline-primary">
            <i class="fas fa-plus me-2"></i>Create New Room
          </a>
        </div>
      </div>
    <% } %>
  </div>
</section>